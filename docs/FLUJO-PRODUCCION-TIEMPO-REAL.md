```mermaid
graph TD
    A[Plan de Producciรณn #50] -->|Crear| B[target_quantity: 1000]
    B -->|Iniciar Jornada| C[WorkShift #36]
    C -->|Snapshot| D[target_snapshot: 1000]
    C -->|Inicializar| E[actual_production: 0]
    
    E -->|Simulaciรณn cada 5s| F{SimulateProduction Job}
    F -->|+1 a +5 unidades| G[Incrementar actual_production]
    G -->|Calcular| H[good_units = 95%]
    G -->|Calcular| I[defective_units = 5%]
    
    H -->|Validar| J{good + defective = actual?}
    I -->|Validar| J
    J -->|โ Sรญ| K[Guardar en BD]
    J -->|โ No| L[ERROR: Inconsistencia]
    
    K -->|Broadcast| M[ProductionUpdated Event]
    M -->|WebSocket| N[Frontend Alpine.js]
    
    N -->|Actualizar| O[Tarjeta: Producciรณn Real]
    N -->|Actualizar| P[Tarjeta: Eficiencia]
    N -->|Actualizar| Q[Tarjeta: Tasa Calidad]
    N -->|Actualizar| R[Tarjeta: Tasa Defectos]
    N -->|Actualizar| S[Grรกfico de Barras]
    
    G -->|Verificar| T{actual >= target?}
    T -->|No| F
    T -->|Sรญ| U[status = pending_registration]
    U -->|Usuario confirma| V[Finalizar Jornada]
    V -->|Crear| W[ProductionData Record]
    V -->|Actualizar| X[Plan status = completed]
    
    style A fill:#f9f,stroke:#333,stroke-width:2px
    style C fill:#bbf,stroke:#333,stroke-width:2px
    style G fill:#bfb,stroke:#333,stroke-width:2px
    style M fill:#fbb,stroke:#333,stroke-width:2px
    style S fill:#fbf,stroke:#333,stroke-width:2px
    style V fill:#bff,stroke:#333,stroke-width:2px
```

# Diagrama de Flujo: Sistema de Producciรณn en Tiempo Real

## ๐ Mรฉtricas Calculadas

### 1. Eficiencia de Producciรณn
```
Eficiencia = (Producciรณn Real / Producciรณn Planificada) ร 100

Ejemplo:
- Producciรณn Planificada: 1000 unidades
- Producciรณn Real: 950 unidades
- Eficiencia: (950 / 1000) ร 100 = 95%
```

### 2. Tasa de Calidad
```
Tasa de Calidad = (Unidades Buenas / Producciรณn Real) ร 100

Ejemplo:
- Producciรณn Real: 950 unidades
- Unidades Buenas: 903 unidades
- Tasa de Calidad: (903 / 950) ร 100 = 95.05%
```

### 3. Tasa de Defectos
```
Tasa de Defectos = (Unidades Defectuosas / Producciรณn Real) ร 100

Ejemplo:
- Producciรณn Real: 950 unidades
- Unidades Defectuosas: 47 unidades
- Tasa de Defectos: (47 / 950) ร 100 = 4.95%
```

## ๐ Ciclo de Actualizaciรณn en Tiempo Real

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    SIMULADOR DE PRODUCCIรN                       โ
โ                      (cada 5 segundos)                           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                                โ
                                โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  1. Incremento Aleatorio: +1 a +5 unidades                       โ
โ  2. Calcular Buenas: 95% del total acumulado                     โ
โ  3. Calcular Defectuosas: total - buenas                         โ
โ  4. Validar: buenas + defectuosas = total                        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                                โ
                                โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                   GUARDAR EN BASE DE DATOS                       โ
โ                                                                  โ
โ  work_shifts:                                                    โ
โ    - actual_production (int)                                     โ
โ    - good_units (int)                                            โ
โ    - defective_units (int)                                       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                                โ
                                โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ             BROADCAST (WebSocket - Laravel Echo)                 โ
โ                                                                  โ
โ  Canal: work-shift.{id}                                          โ
โ  Evento: production.updated                                      โ
โ  Datos: {                                                        โ
โ    actual_production,                                            โ
โ    good_units,                                                   โ
โ    defective_units,                                              โ
โ    production_efficiency,                                        โ
โ    quality_rate,                                                 โ
โ    defect_rate                                                   โ
โ  }                                                               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                                โ
                                โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ              FRONTEND (Alpine.js + Chart.js)                     โ
โ                                                                  โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ  โ Tarjeta 1: Producciรณn Real                              โ   โ
โ  โ ๐ต 950 / 1000                                           โ   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ                                                                  โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ  โ Tarjeta 2: Eficiencia de Producciรณn                     โ   โ
โ  โ ๐ต 95.0%                                                โ   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ                                                                  โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ  โ Tarjeta 3: Tasa de Calidad                              โ   โ
โ  โ ๐ข 95.1%                                                โ   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ                                                                  โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ  โ Tarjeta 4: Tasa de Defectos                             โ   โ
โ  โ ๐ข 4.9%                                                 โ   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ                                                                  โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ  โ           GRรFICO DE BARRAS                             โ   โ
โ  โ                                                         โ   โ
โ  โ  1000 โ โโโโโโโโโโโโโโโโโโโโโโโโโ  Producciรณn Planificada โ
โ  โ   950 โ โโโโโโโโโโโโโโโโโโโโโโโโ   Producciรณn Real     โ   โ
โ  โ   903 โ โโโโโโโโโโโโโโโโโโโโโโโ    Unidades Buenas     โ   โ
โ  โ    47 โ โโ                         Unidades Defectuosasโ   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## ๐จ Cรณdigo de Colores de las Mรฉtricas

### Eficiencia de Producciรณn
```
๐ข Verde  (โฅ100%):  Sobre cumplimiento - Excelente
๐ต Azul   (90-99%): Dentro del objetivo - Bueno
๐ก Amarillo (75-89%): Por debajo del objetivo - Aceptable
๐ด Rojo   (<75%):   Muy bajo - Requiere intervenciรณn
```

### Tasa de Calidad
```
๐ข Verde  (โฅ95%):  Calidad รณptima
๐ก Amarillo (90-94%): Calidad aceptable
๐ด Rojo   (<90%):   Problemas de calidad
```

### Tasa de Defectos
```
๐ข Verde  (<5%):   Muy bueno
๐ก Amarillo (5-9%):  Aceptable
๐ด Rojo   (โฅ10%):   Requiere mejoras
```

## ๐ฑ Captura de Pantalla (Mockup)

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    โฑ๏ธ Jornada #36        [โถ๏ธ Activo]              โ
โ                    Mรกquina CNC-001                                โ
โ                                                [Volver] [Finalizar]โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                   โ
โ  โโโโโโโโโโโโ  โโโโโโโโโโโโ  โโโโโโโโโโโโ  โโโโโโโโโโโโ         โ
โ  โ ๐ต 950   โ  โ ๐ต 95.0% โ  โ ๐ข 95.1% โ  โ ๐ข 4.9%  โ         โ
โ  โ Producciรณnโ  โ Eficienciaโ  โ  Tasa de โ  โ  Tasa de โ         โ
โ  โ   Real   โ  โ Producciรณnโ  โ  Calidad โ  โ Defectos โ         โ
โ  โ de 1000  โ  โ โโโโโโโโโโ  โ 903 buenasโ  โ47 defectosโ        โ
โ  โโโโโโโโโโโโ  โโโโโโโโโโโโ  โโโโโโโโโโโโ  โโโโโโโโโโโโ         โ
โ                                                                   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ  โ           Progreso de Producciรณn                            โ โ
โ  โ                                                             โ โ
โ  โ  โโโโโโโโโโโโโโโโโโโโโโโโโ  1000  Producciรณn Planificada   โ โ
โ  โ  โโโโโโโโโโโโโโโโโโโโโโโโ    950  Producciรณn Real          โ โ
โ  โ  โโโโโโโโโโโโโโโโโโโโโโโ     903  Unidades Buenas          โ โ
โ  โ  โโ                           47  Unidades Defectuosas     โ โ
โ  โ                                                             โ โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ                                                                   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ  โ Informaciรณn de la Jornada                                   โ โ
โ  โ                                                             โ โ
โ  โ Equipo: CNC-001                Turno: ๐ Maรฑana            โ โ
โ  โ Producto: Widget A             Plan: #50                   โ โ
โ  โ Operador: Juan Pรฉrez           Inicio: 11/11 06:00         โ โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ                                                                   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```
